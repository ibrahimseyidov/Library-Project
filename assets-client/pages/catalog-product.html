<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style/reset.css">
    <link rel="stylesheet" href="../style/style.css">
    <link rel="stylesheet" href="../style/catalogProduct.css">
    <link rel="stylesheet" href="../mobile-style/mobile.css">
    <link rel="stylesheet" href="../mobile-style/catalog-product.css">
    <link rel="stylesheet" href="../style/slick.css">
    <link rel="stylesheet" href="../style/jquery.shCircleLoader.css">
    <link rel="stylesheet" href="../style/toast.style.css">
    <title>Catalog Page</title>
</head>

<body>

    <header class="header">

        <div class="header-container catalog-header">

            <div>
                <a href="../../index.html"><img src="../img/topLogo.svg" alt="logo"></a>
            </div>

            <div class="top-nav">
                <nav>
                    <ul class="home-nav">
                        <li><a href="../../index.html">Home</a></li>
                        <li><a href="./catalog-product.html" class="active">Catalog</a></li>
                        <li><a href="./about.html">About Store</a></li>
                        <li><a href="./contact.html">Contact Us</a></li>
                        <li><a href="./search.html">Search</a></li>
                    </ul>
                </nav>
            </div>

            <div class="join-us">
                <img src="../icons/profile.svg" alt="profile">
                <a id="myBtn">Join Us</a>
            </div>

            <div class="mobile-ham">
                <button class="join-img" id="myBtnMobile"><img src="../icons/profile.svg" alt="profile"></button>
                <button onclick="openNav()">
                    <img src="../icons/hamMenu.svg" alt="hamburger-menu">
                </button>
            </div>

        </div>

        <div id="myNav" class="overlay">


            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>


            <div class="overlay-content">
                <a href="../../index.html">Home</a>
                <a href="./catalog-product.html">Catalog</a>
                <a href="./about.html">About Store</a>
                <a href="./contact.html">Contact Us</a>
                <a href="./search.html">Search</a>
            </div>

        </div>


        <div id="myModal" class="modal">

            <div class="modal-content">
                <span class="close"></span>

                <div class="join-modal">
                    <span>Join Us</span>
                    <div class="join-inp">
                        <input type="text" id="fullname" placeholder="Full name">
                        <input type="email" id="email" placeholder="Email">
                    </div>
                    <div class="join-btn">
                        <button id="joinbtn">Join</button>
                    </div>
                </div>
            </div>

        </div>

    </header>

    <main>

        <div class="contain">

            <div class="categorie-page" style="display: block;">

                <div class="catalog-container">

                    <div class="all-books">
                        <h2>All Books</h2>
                    </div>

                    <div class="catalog-links" id="categorieContainer">
                        <a href="#">All</a>
                        <!-- <a href="#">Fantastic</a>
                        <a href="#">Bestseller</a>
                        <a href="#">Dedective</a>
                        <a href="#">Classic</a>
                        <a href="#">Baby</a> -->
                    </div>

                </div>

                <section>

                    <div class="books-slider-container" id="bookSlider">
                        <div class="example"></div>
                    </div>

                </section>

                <section>

                    <div class="best-seller">
                        <h2>Bestseller</h2>
                    </div>

                    <div class="books-slider-container second-container" id="bookSlider2">
                        <div class="example"></div>

                    </div>

                </section>

                <section>

                    <div class="best-seller">
                        <h2>New releases</h2>
                    </div>

                    <div class="books-slider-container third-container" id="bookSlider3">
                        <div class="example"></div>
                    </div>

                    <div class="right-btn" style="display: none;">
                        <img src="../icons/rightBtn.svg" alt="right-btn">
                    </div>

            </div>

            </section>


            <div id="bookInfo" style="display: none;">

                <div>

                    <div class="back-btn">
                        <button id="backBtn">
                            < BACK</button>
                    </div>

                    <div class="all-book-container">

                        <div class="book-left-container">

                            <div class="book-top">
                                <!-- 
                                <div class="about-book">

                                    <div>
                                        <span>2017</span>
                                    </div>

                                    <div class="content-book">
                                        <h2>Order in Chaous</h2>
                                        <span>2 days ago added</span>
                                        <h3>Konstantin Koptelov</h3>
                                        <p>
                                            s of Kiev can receive an order on the day of its registration. Customers
                                            from
                                            other
                                            cities
                                            of Ukraine can receive an order within 1-5 days, depending on the location
                                            of
                                            the
                                            settlement
                                            and the selected delivery method. Orders over UAH 1000 are delivered free of
                                            charge
                                            *.
                                            You
                                            can see the available methods, exact terms and cost of delivery during
                                            checkout
                                            in
                                            the
                                            order
                                            basket, after selecting the delivery city.
                                        </p>
                                        <button>More details</button>
                                    </div>

                                </div> -->

                            </div>

                            <div class="book-bottom">

                                <div class="comment-search">
                                    <div>
                                        <input type="text" id="commentInp" placeholder="your anonim comment...">
                                    </div>
                                    <div>
                                        <button><img class="send-btn" src="../icons/sendIcon.svg" alt="send"></button>
                                    </div>
                                </div>
                                <div id="bookComment">
                                </div>
                                <!-- <div class="book-comment">
                                    <div class="anonim-comment">
                                        <span>anonim</span>
                                        <span>18:32 today</span>
                                    </div>
                                    <div class="anonim-para">
                                        <p>
                                            Woah, your project looks awesome! How long have you been coding for? I’m
                                            still
                                            new,
                                            but think I want to dive into React as well soon. Perhaps you can give me an
                                            insight
                                            on where I can learn React? Thanks!
                                        </p>
                                    </div>
                                </div> -->

                                <!-- <div class="book-comment">
                                    <div class="anonim-comment">
                                        <span>anonim</span>
                                        <span>18:32 today</span>
                                    </div>
                                    <div class="anonim-para">
                                        <p>
                                            Woah, your project looks awesome! How long have you been coding for? I’m
                                            still
                                            new,
                                            but think I want to dive into React as well soon. Perhaps you can give me an
                                            insight
                                            on where I can learn React? Thanks!
                                        </p>
                                    </div>
                                </div> -->

                            </div>

                        </div>

                        <div class="book-right-container">
                            <!-- <img src="../img/productBook.svg" alt="product-book"> -->
                        </div>

                    </div>

                </div>


            </div>


            <section class="five-sec">

                <div class="follow">
                    <h3>Follow us on social media</h3>
                </div>

                <div class="media-icon">
                    <a href="https://www.facebook.com/" target="_blank"><img src="../icons/facebook.svg"
                            alt="facebook"></a>
                    <a href="https://twitter.com/" class="twitter" target="_blank"><img src="../icons/twitter.svg"
                            alt="twitter"></a>
                    <a href="https://www.instagram.com/" target="_blank"><img src="../icons/instagram.svg"
                            alt="instagram"></a>
                </div>

            </section>
        </div>

        </div>

    </main>

    <footer class="footer-sec">

        <div class="contain">

            <div class="footer-area">

                <div class="bottom-logo">
                    <img src="../img/bottomLogo.svg" alt="logo">
                </div>

                <div class="footer-right">

                    <div class="footer-nav">
                        <h3>Popular</h3>
                        <ul>
                            <li><a href="#">Programming</a></li>
                            <li><a href="#">Books for children</a></li>
                            <li><a href="#">Psychology</a></li>
                            <li><a href="#">Business</a></li>
                        </ul>
                    </div>

                    <div class="footer-nav">
                        <h3>Cash</h3>
                        <ul>
                            <li><a href="#">Delivery</a></li>
                            <li><a href="#">Payment</a></li>
                            <li><a href="#">About the store</a></li>
                        </ul>
                    </div>

                    <div class="footer-nav" style="margin-right: 0;">
                        <h3>Help</h3>
                        <ul>
                            <li><a href="#">Contacts</a></li>
                            <li><a href="#">Purchase returns</a></li>
                            <li><a href="#">Buyer help</a></li>
                        </ul>
                    </div>

                </div>

            </div>

            <div class="copyright">
                <p>All rights reserved © 2003-2021 LIBRARY TERMS OF USE | Privacy Policy</p>
            </div>

        </div>

    </footer>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
        integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="../js/jquery.shCircleLoader.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <script src="../js/toast.script.js"></script>
    <script src="../js/slickSlider.js"></script>
    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
        import { getDatabase, set, get, ref, push, child, onValue, query, orderByChild, equalTo } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBIwPUrIeIwVhdFOO24FP37qBLiHeLIsRw",
            authDomain: "library-project-3c5d6.firebaseapp.com",
            databaseURL: "https://library-project-3c5d6-default-rtdb.firebaseio.com",
            projectId: "library-project-3c5d6",
            storageBucket: "library-project-3c5d6.appspot.com",
            messagingSenderId: "294284130679",
            appId: "1:294284130679:web:51ed25900557833811c972"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const bookSlider = document.querySelector("#bookSlider");
        const bookSlider2 = document.querySelector("#bookSlider2");
        const bookSlider3 = document.querySelector("#bookSlider3");
        const categorieContainer = document.querySelector("#categorieContainer");
        const categoriePage = document.querySelector(".categorie-page");
        const bookInfo = document.querySelector("#bookInfo");
        const bookTop = document.querySelector(".book-top");
        const bookImageContainer = document.querySelector(".book-right-container");
        const sendBtn = document.querySelector(".send-btn");
        const commentArea = document.querySelector("#bookComment");
        const fullname = document.querySelector("#fullname");
        const email = document.querySelector("#email");
        const joinbtn = document.querySelector("#joinbtn");

        categorieContainer.addEventListener("click", fetchTrueCategorie);
        document.addEventListener("DOMContentLoaded", getCategorie);
        document.addEventListener("DOMContentLoaded", getData());
        sendBtn.addEventListener("click", showUserComment);
        joinbtn.addEventListener("click", joinUs);

        function firstSlider() {
            $(".books-slider-container").slick({
                prevArrow: `<div class="left-btn">
        <img src="../icons/leftBtn.svg" alt="left-btn">
        </div>`,
                nextArrow: `<div class="right-btn">
        <img src="../icons/rightBtn.svg" alt="right-btn">
        </div>`,
                slidesToShow: 5,
                autoplay: true,
                autoplaySpeed: 2000,
                arrows: true,
                adaptiveHeight: false,
                responsive: [
                    {
                        breakpoint: 1526,
                        settings: {
                            slidesToShow: 4,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 1221,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 1095,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 763,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 1,
                            arrows: false,
                        }
                    },
                    {
                        breakpoint: 544,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            arrows: false,
                        }
                    }
                ]
            });

        }

        function secondSlider() {
            $("#bookSlider2").slick({
                prevArrow: `<div class="left-btn">
                                <img src="../icons/leftBtn.svg" alt="left-btn">
                                </div>`,
                nextArrow: `<div class="right-btn">
                                <img src="../icons/rightBtn.svg" alt="right-btn">
                                </div>`,
                slidesToShow: 5,
                autoplay: true,
                autoplaySpeed: 2000,
                arrows: true,
                responsive: [
                    {
                        breakpoint: 1526,
                        settings: {
                            slidesToShow: 4,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 1221,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 1095,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 763,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 1,
                            arrows: false,
                        }
                    },
                    {
                        breakpoint: 544,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            arrows: false,
                        }
                    }
                ]
            });
        }

        function thirdSlider() {
            $("#bookSlider3").slick({
                prevArrow: `<div class="left-btn">
                                <img src="../icons/leftBtn.svg" alt="left-btn">
                                </div>`,
                nextArrow: `<div class="right-btn">
                                <img src="../icons/rightBtn.svg" alt="right-btn">
                                </div>`,
                slidesToShow: 5,
                autoplay: true,
                autoplaySpeed: 2000,
                arrows: true,
                responsive: [
                    {
                        breakpoint: 1526,
                        settings: {
                            slidesToShow: 4,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 1221,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 1095,
                        settings: {
                            slidesToShow: 3,
                            slidesToScroll: 1,
                            arrows: true,
                        }
                    },
                    {
                        breakpoint: 763,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 1,
                            arrows: false,
                        }
                    },
                    {
                        breakpoint: 544,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1,
                            arrows: false,
                        }
                    }
                ]
            });
        }

        function getCategorie() {

            get(ref(db, "categories"))
                .then((snapshot) => {
                    const data = snapshot.val()
                    const dataArr = Object.entries(data)
                    let currentURL = window.location.href
                    dataArr.forEach((el) => {
                        categorieContainer.innerHTML += `<a href="#">${el[1].categorie}</a>`
                    })
                })
        }

        function fetchTrueCategorie(e) {
            let categorieName = e.target.textContent;
            bookSlider.innerHTML = "";

            const que = query(ref(db, "book-data"), orderByChild("categories"), equalTo(`${categorieName}`))

            if (categorieName == "All") {
                location.reload()
            }

            get(que)
                .then((snapshot) => {

                    if (snapshot.exists()) {
                        let data = snapshot.val();
                        let dataArr = Object.entries(data);
                        let completed = false;

                        dataArr.forEach((el, i) => {
                            if (el[1].isNew) {

                                bookSlider.innerHTML += `<div class="bg-book">
                            <div class="new-icon">
                                <img src='../icons/new.svg' alt="new">
                            </div>

                        <div class="book-main">
                            <img src="${el[1].bookImage}" alt="book">
                            <h3>${el[1].bookName.length > 18 ? el[1].bookName.slice(0, 18) + "..." : el[1].bookName}</h3>
                            <span>${el[1].authorName.length > 18 ? el[1].authorName.slice(0, 18) + "..." : el[1].authorName}</span>
                            <button>READ MORE</button>
                        </div>

                        </div>`


                            } else if (!el[1].isNew) {

                                bookSlider.innerHTML += `<div class="bg-book">
                                             <div class="book-main">
                                                <img src="${el[1].bookImage}" alt="book">
                            <h3>${el[1].bookName.length > 18 ? el[1].bookName.slice(0, 18) + "..." : el[1].bookName}</h3>
                            <span>${el[1].authorName.length > 18 ? el[1].authorName.slice(0, 18) + "..." : el[1].authorName}</span>
                            <button>READ MORE</button>
                        </div>

                        </div>`

                            }

                        })

                    }
                })


                .catch((err) => {
                    console.log(err);
                })

        }

        function getData() {
            $(".example").shCircleLoader({
                color: "#E16A00",
            })
            let dbref = ref(db, "book-data")

            get(ref(db, "book-data"))
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        bookSlider.innerHTML = ""
                        let data = snapshot.val();
                        let dataArr = Object.entries(data);

                        dataArr.forEach((el) => {
                            if (el[1].isNew) {
                                bookSlider.innerHTML += `<div class="bg-book">
                            <div class="new-icon">
                                <img src='../icons/new.svg' alt="new">
                            </div>

                        <div class="book-main">
                            <img src="${el[1].bookImage}" alt="book">
                            <h3>${el[1].bookName.length > 18 ? el[1].bookName.slice(0, 18) + "..." : el[1].bookName}</h3>
                            <span>${el[1].authorName.length > 18 ? el[1].authorName.slice(0, 18) + "..." : el[1].authorName}</span>
                            <button class="read">READ MORE</button>
                            <div style="display:none;">${el[1].bookId}</div>
                        </div>

                        </div>`
                            } else {
                                bookSlider.innerHTML += `<div class="bg-book">
                        <div class="book-main">
                            <img src="${el[1].bookImage}" alt="book">
                            <h3>${el[1].bookName.length > 18 ? el[1].bookName.slice(0, 18) + "..." : el[1].bookName}</h3>
                            <span>${el[1].authorName.length > 18 ? el[1].authorName.slice(0, 18) + "..." : el[1].authorName}</span>
                            <button class="read">READ MORE</button>
                            <div style="display:none;">${el[1].bookId}</div>
                        </div>
                        </div>`


                            }

                        })
                        bookSlider2.innerHTML = ""
                        dataArr.forEach((el) => {
                            if (el[1].isNew && el[1].categories == "Bestseller") {
                                bookSlider2.innerHTML += `<div class="bg-book">
                            <div class="new-icon">
                                <img src='../icons/new.svg' alt="new">
                            </div>

                        <div class="book-main">
                            <img src="${el[1].bookImage}" alt="book">
                            <h3>${el[1].bookName.length > 18 ? el[1].bookName.slice(0, 18) + "..." : el[1].bookName}</h3>
                            <span>${el[1].authorName.length > 18 ? el[1].authorName.slice(0, 18) + "..." : el[1].authorName}</span>
                            <button class="read">READ MORE</button>
                        </div>

                        </div>`
                            } else if (el[1].categories == "Bestseller") {
                                bookSlider2.innerHTML += `<div class="bg-book">
                        <div class="book-main">
                            <img src="${el[1].bookImage}" alt="book">
                            <h3>${el[1].bookName.length > 18 ? el[1].bookName.slice(0, 18) + "..." : el[1].bookName}</h3>
                            <span>${el[1].authorName.length > 18 ? el[1].authorName.slice(0, 18) + "..." : el[1].authorName}</span>
                            <button class="read">READ MORE</button>
                        </div>
                        </div>`


                            }

                        })
                        bookSlider3.innerHTML = ""
                        dataArr.forEach((el, i) => {
                            if (el[1].isNew) {
                                bookSlider3.innerHTML += `<div class="bg-book">
                            <div class="new-icon">
                                <img src='../icons/new.svg' alt="new">
                            </div>

                        <div class="book-main">
                            <img src="${el[1].bookImage}" alt="book">
                            <h3>${el[1].bookName.length > 18 ? el[1].bookName.slice(0, 18) + "..." : el[1].bookName}</h3>
                            <span>${el[1].authorName.length > 18 ? el[1].authorName.slice(0, 18) + "..." : el[1].authorName}</span>
                            <button class="read">READ MORE</button>
                        </div>

                        </div>`
                            }


                        })

                        firstSlider()
                        secondSlider()
                        thirdSlider()

                        function firstSlider() {
                            $(".books-slider-container").slick({
                                prevArrow: `<div class="left-btn">
                                <img src="../icons/leftBtn.svg" alt="left-btn">
                                </div>`,
                                nextArrow: `<div class="right-btn">
                                <img src="../icons/rightBtn.svg" alt="right-btn">
                                </div>`,
                                slidesToShow: 5,
                                autoplay: true,
                                autoplaySpeed: 2000,
                                arrows: true,
                                adaptiveHeight: false,
                                responsive: [
                                    {
                                        breakpoint: 1526,
                                        settings: {
                                            slidesToShow: 4,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 1221,
                                        settings: {
                                            slidesToShow: 3,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 1095,
                                        settings: {
                                            slidesToShow: 3,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 763,
                                        settings: {
                                            slidesToShow: 2,
                                            slidesToScroll: 1,
                                            arrows: false,
                                        }
                                    },
                                    {
                                        breakpoint: 544,
                                        settings: {
                                            slidesToShow: 1,
                                            slidesToScroll: 1,
                                            arrows: false,
                                        }
                                    }
                                ]
                            });

                        }
                        function secondSlider() {
                            $("#bookSlider2").slick({
                                prevArrow: `<div class="left-btn">
                                <img src="../icons/leftBtn.svg" alt="left-btn">
                                </div>`,
                                nextArrow: `<div class="right-btn">
                                <img src="../icons/rightBtn.svg" alt="right-btn">
                                </div>`,
                                slidesToShow: 5,
                                autoplay: true,
                                autoplaySpeed: 2000,
                                arrows: true,
                                responsive: [
                                    {
                                        breakpoint: 1526,
                                        settings: {
                                            slidesToShow: 4,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 1221,
                                        settings: {
                                            slidesToShow: 3,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 1095,
                                        settings: {
                                            slidesToShow: 3,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 763,
                                        settings: {
                                            slidesToShow: 2,
                                            slidesToScroll: 1,
                                            arrows: false,
                                        }
                                    },
                                    {
                                        breakpoint: 544,
                                        settings: {
                                            slidesToShow: 1,
                                            slidesToScroll: 1,
                                            arrows: false,
                                        }
                                    }
                                ]
                            });
                        }
                        function thirdSlider() {
                            $("#bookSlider3").slick({
                                prevArrow: `<div class="left-btn">
                                <img src="../icons/leftBtn.svg" alt="left-btn">
                                </div>`,
                                nextArrow: `<div class="right-btn">
                                <img src="../icons/rightBtn.svg" alt="right-btn">
                                </div>`,
                                slidesToShow: 5,
                                autoplay: true,
                                autoplaySpeed: 2000,
                                arrows: true,
                                responsive: [
                                    {
                                        breakpoint: 1526,
                                        settings: {
                                            slidesToShow: 4,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 1221,
                                        settings: {
                                            slidesToShow: 3,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 1095,
                                        settings: {
                                            slidesToShow: 3,
                                            slidesToScroll: 1,
                                            arrows: true,
                                        }
                                    },
                                    {
                                        breakpoint: 763,
                                        settings: {
                                            slidesToShow: 2,
                                            slidesToScroll: 1,
                                            arrows: false,
                                        }
                                    },
                                    {
                                        breakpoint: 544,
                                        settings: {
                                            slidesToShow: 1,
                                            slidesToScroll: 1,
                                            arrows: false,
                                        }
                                    }
                                ]
                            });
                        }
                    }
                })
                .catch((error) => {
                    console.log(error);
                });
        }

        $(document).on("click", ".read", function () {
            localStorage.setItem("sectionState", "visible")
            $(".categorie-page").fadeOut();
            $("#bookInfo").fadeIn()

            let currentCard = this.parentElement;

            console.log(this.parentElement);
            console.log(currentCard.children[1].textContent);
            console.log(currentCard.children[2].textContent);

            var settings = {
                "url": "https://blog-api-t6u0.onrender.com/posts",
                "method": "GET",
                "timeout": 0,
                "headers": {
                    "Content-Type": "application/json"
                },
            };

            $.ajax(settings)
                .then((response) => {
                    console.log(response);
                    for (let i = 100; i < response.length; i++) {
                        let title = response[i].userData.title
                        let comment = response[i].userData.body
                        commentArea.innerHTML += `<div class="book-comment">
                                    <div class="anonim-comment">
                                        <span>anonim</span>
                                        <span>${title}</span>
                                    </div>
                                    <div class="anonim-para">
                                        <p>${comment}</p>
                                    </div>
                                </div>`
                    }
                })
                .catch(() => {
                    console.log("error");
                })

            get(ref(db, "book-data/"))
                .then((snapshot) => {
                    let data = snapshot.val();
                    let dataArr = Object.entries(data);

                    dataArr.forEach((el) => {
                        if (el[1].bookId == currentCard.children[4].textContent) {
                            bookTop.innerHTML = `<div class="about-book">

                                <div>
                                    <span>${el[1].publishYear}</span>
                                </div>

                                <div class="content-book">
                                    <h2>${el[1].bookName}</h2>
                                    <span>2 days ago added</span>
                                    <h3>${el[1].authorName}</h3>
                                    <p>
                                        ${el[1].description}
                                    </p>
                                    <button>More details</button>
                                </div>

                                </div>`

                            bookImageContainer.innerHTML = `<div class="book-right-container">
                            <img src="${el[1].bookImage}" alt="product-book">
                        </div>`

                            localStorage.setItem("publishYear", el[1].publishYear)
                            localStorage.setItem("bookName", el[1].bookName)
                            localStorage.setItem("authorName", el[1].authorName)
                            localStorage.setItem("description", el[1].description)
                            localStorage.setItem("bookImage", el[1].bookImage);
                        } else {
                            console.log("Data Not Found");
                        }
                    })
                })
                .catch(() => {
                    console.log("error");
                })



        })

        function showUserComment() {
            let userComment = $("#commentInp").val()
            let now1 = moment()
            let publishDate = now1.format('YYYY-MM-DD HH:mm');
            var diffSeconds = now1.diff(publishDate, 'seconds');
            var diffMinutes = now1.diff(publishDate, 'minutes');
            var diffHours = now1.diff(publishDate, 'hours');
            console.log(publishDate);
            let displayText = "";

            if (diffSeconds < 60) {
                displayText = 'A few seconds ago';
            } else if (diffMinutes < 60) {
                displayText = diffMinutes + ' minutes ago';
            } else if (diffHours < 24) {
                displayText = diffHours + ' hours ago';
            } else {
                displayText = postTime.format('YYYY-MM-DD HH:mm');
            }


            if (userComment) {
                commentArea.innerHTML += `<div class="book-comment">
                                    <div class="anonim-comment">
                                        <span>anonim</span>
                                        <span>${displayText}</span>
                                    </div>
                                    <div class="anonim-para">
                                        <p>${userComment}</p>
                                    </div>
                                </div>`

                $("#commentInp").val("")

                let userData = {
                    "title": `${publishDate}`,
                    "body": `${userComment}`
                }

                var settings = {
                    "url": "https://blog-api-t6u0.onrender.com/posts",
                    "method": "POST",
                    "timeout": 0,
                    "headers": {
                        "Content-Type": "application/json"
                    },
                    "data": JSON.stringify({ userData }),
                };

                $.ajax(settings)
                    .then((response) => {
                        $.Toast("Success", "Comment Added Successfully", "success", {
                            position_class: 'toast-top-right',
                            timeout: 4000,
                            has_progress: true,
                            width: 300
                        })
                    })
                    .catch(() => {
                        alert("err")
                    })
            } else {
                $.Toast("Error", "Please, Enter Your Comment", "error", {
                    position_class: 'toast-top-right',
                    timeout: 4000,
                    has_progress: true,
                    width: 300
                })
            }

        }

        function joinUs(e) {
            e.preventDefault();

            if (fullname.value && email.value && validateEmail(email.value)) {
                push(ref(db, "join-us-data/"), {
                    fullName: fullname.value,
                    emailAddress: email.value,
                })
                    .then(() => {
                        $.Toast(
                            "Successful",
                            "You Joined With Us Successfully",
                            "success",
                            {
                                position_class: "toast-top-right",
                                timeout: 4000,
                                has_progress: true,
                                width: 300,
                            }
                        );
                    })

                    .catch((error) => {
                        $.Toast("Warning", "Data Could not Send", "warning", {
                            position_class: "toast-top-right",
                            timeout: 4000,
                            has_progress: true,
                            width: 300,
                        });
                    });
            } else {
                $.Toast("Unsuccessful", "Please, Enter Valid Email and Username", "error", {
                    position_class: "toast-top-right",
                    timeout: 4000,
                    has_progress: true,
                    width: 300,
                });
            }
            fullname.value = "";
            email.value = "";
        }

        function validateEmail(email) {
            const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return regex.test(email);
        }

        $(document).on("click", "#backBtn", function () {
            localStorage.setItem("sectionState", "invisible")
            $("#bookInfo").fadeOut()
            $(".categorie-page").fadeIn()
            localStorage.removeItem("publishYear");
            localStorage.removeItem("bookName");
            localStorage.removeItem("authorName");
            localStorage.removeItem("description");
            localStorage.removeItem("bookImage");
            location.reload()
        })

    </script>
    <script src="../js/showPage.js"></script>
    <script src="../js/modal.js"></script>
    <script src="../js/hamburger.js"></script>

</body>

</html>